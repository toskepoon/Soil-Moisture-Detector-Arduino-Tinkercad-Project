#include <LiquidCrystal.h>

// A0 пин дээр "sl" нэр өгсөн – хөрсний чийгшлийг шалгана
const int sl = A0; 

// 9-пин дээр "pnsk" нэр өгсөн – LED-ийн зориулалттай
const int pnsk = 9; 

// 8-пин дээр "asa" нэр өгсөн – дуу гаргагч (buzzer)-ийн зориулалттай
const int asa = 8; 

// LCD-г дараах пинуудтай холбосон
LiquidCrystal lcd(7, 6, 5, 4, 3, 2); 

void setup() {
  lcd.begin(16, 2); // 16x2 LCD-г асаана
  lcd.setCursor(0, 0); // курсорыг эхний мөрөнд байрлуулна
  lcd.print("Moisture level: "); // эхний мөрөнд текст гаргана

  pinMode(sl, INPUT); // хөрсний чийг мэдрэгчийг оролт болгон тохируулна
  pinMode(pnsk, OUTPUT); // LED-г гаралт болгон тохируулна
  pinMode(asa, OUTPUT); // дуу гаргагчийг гаралт болгон тохируулна

  Serial.begin(9600); // компьютертэй холболт үүсгэнэ
  delay(1000); // бага зэрэг хүлээнэ
}

void perfectCondition() {
  lcd.clear(); 
  lcd.setCursor(0, 0);
  lcd.print("Soil is perfect"); // бүгд хэвийн байна

  digitalWrite(asa, LOW); // дуу унтарна
  noTone(pnsk); // LED-ээс дуу гарахгүй
}

void alertCondition() {
  tone(pnsk, 1000); // LED дуу гаргана
  digitalWrite(asa, HIGH); // дуу гаргагч ажиллана
  delay(200);
  digitalWrite(asa, LOW); // дуу зогсоно
  noTone(pnsk); // дууг зогсооно
  delay(200);
}

void loop() {
  int cval = analogRead(sl); // чийгшлийн утгыг уншина
  Serial.print("Moisture Value: ");
  Serial.println(cval); // монитор руу хэвлэнэ

  lcd.setCursor(0, 1); // хоёр дахь мөрөнд бичнэ
  lcd.print("Value: ");
  lcd.print(cval); // утгыг харуулна
  lcd.print("   "); // хуучин тоонуудыг цэвэрлэнэ

  // Шалгах: хэт нойтон эсвэл хэт хуурай бол дохио өгнө
  if (cval > 601) {
    alertCondition();
  } else if (cval < 300) {
    alertCondition();
  } else {
    perfectCondition(); // бүгд хэвийн байвал
  }
}
